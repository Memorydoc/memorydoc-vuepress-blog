---
title: 事件模式二
date: 2022-03-23 22:09:52
permalink: /pages/76c1e1213/
titleTag: 原创
categories: 
  - 技术架构
  - 设计模式
tags: 
  - 
---
  
## Spring事件机制


## Spring4.2 之前
### Spring事件
```java 
public class Event extends ApplicationEvent {
    private String message;

    public EventDemo(Object source) {
        super(source);
    }

    public String getMessage() {
        return message;
    }

    public void setMessage(String message) {
        this.message = message;
    }
}

```
### 事件监听器
```java 
@Component
public class EventLinstener implements ApplicationListener<Event> {

    @Override
    public void onApplicationEvent(Event demo) {
        System.out.println("收到了监听的消息" + JSONObject.toJSONString(demo));
    }
}

```
### 事件发布器
``` java 
@Component
public class EventPublish {

    /**
     * 由spring创建注入
     */
    @Autowired
    private ApplicationEventPublisher applicationEventPublisher;

    public void publish(String message){
        Event ev = new Event(this);
        demo.setMessage(message);
        applicationEventPublisher.publishEvent(ev);
    }

}

```

## Spring4.2+ 之后
### 使用方式
```java 
/**
 * @program: spring-test
 * @ClassName NewVersionEventListener
 * @description: spring 4.2+ 之后不需要单独编写监听器类 只需要在SpringBean的方法上标记@EventListener注解即可
 * @author: sizegang
 * @Version 1.0
 **/
@Component
public class NewVersionEventListener {


    /**
     * 发送邮件
     */
    @Order(2)
    @EventListener
    public void processSendEmail(Event eventDemo){
        System.out.println("发送邮件");
    }
    /**
     * 添加积分
     * Order 控制执行顺序
     */
    @Order(1)
    @EventListener
    public void addPoints(Event eventDemo){
        System.out.println("添加积分");
    }

}

```
